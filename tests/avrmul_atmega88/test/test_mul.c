#include "avr.h"
#include "print.h"

extern void mul_asm(unsigned char *r, const unsigned char *a, const unsigned char *b);
static void test_mul(void (*func)(unsigned char *, const unsigned char *, const unsigned char *), unsigned int inbytes)
{
  unsigned char a[20] = {0x26, 0xc4, 0xc6, 0xd, 0x69, 0x61, 0x5d, 0x23, 0xb5, 0x54, 0x76, 0xbc, 0x81, 0xb, 0xf8, 0xbc, 0x39, 0x22, 0x1f, 0xe};
  unsigned char b[20] = {0x20, 0x3b, 0x3e, 0x45, 0xb1, 0xf1, 0x6f, 0xa5, 0x7c, 0x1, 0xda, 0x10, 0xb, 0x16, 0xdc, 0x76, 0xd8, 0xf2, 0xbc, 0x15};
  unsigned char r[40] = {0x1, 0x32, 0xfa, 0x11, 0x3e, 0x15, 0x12, 0x33, 0x53, 0xd4, 0x97, 0x63, 0xd1, 0x2a, 0xf2, 0xe1, 0x5f, 0x54, 0x2d, 0x24, 0x21, 0xe9, 0x10, 0x70, 0x7c, 0xc0, 0xee, 0xa, 0x54, 0xd0, 0x8f, 0x48, 0x8, 0xd6, 0xb0, 0x96, 0x47, 0x41, 0x46, 0xc0};
  unsigned int i;

  (*func)(r,a,b);

  bigint_print(a,inbytes);
  print("*");
  bigint_print(b,inbytes);
  print("-");
  bigint_print(r,2*inbytes);
  print("\n");

  //multiply maximal values
  for(i=0;i<inbytes;i++)
    a[i] = b[i] = 0xff;
  (*func)(r,a,b);

  bigint_print(a,inbytes);
  print("*");
  bigint_print(b,inbytes);
  print("-");
  bigint_print(r,2*inbytes);
  print("\n");
}


int main()
{
  test_mul(mul_asm, 20);
  avr_end();
  return 0;
}
